<?xml version="1.0" encoding="UTF-8"?>
<!--

    Copyright 2009 Vastra Gotalandsregionen

      This library is free software; you can redistribute it and/or modify
      it under the terms of version 2.1 of the GNU Lesser General Public
      License as published by the Free Software Foundation.

      This library is distributed in the hope that it will be useful,
      but WITHOUT ANY WARRANTY; without even the implied warranty of
      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
      GNU Lesser General Public License for more details.

      You should have received a copy of the GNU Lesser General Public
      License along with this library; if not, write to the
      Free Software Foundation, Inc., 59 Temple Place, Suite 330,
      Boston, MA 02111-1307  USA

-->
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="
	   http://www.springframework.org/schema/aop
	   http://www.springframework.org/schema/aop/spring-aop-2.5.xsd
		http://www.springframework.org/schema/beans
		http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
		http://www.springframework.org/schema/context
		http://www.springframework.org/schema/context/spring-context-2.5.xsd
		http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.5.xsd">
		

	<!-- Scans for application @Components to deploy -->
	<context:component-scan base-package="org.springframework.webflow.samples.booking" />

	<!-->util:properties id="test" location="classpath:BaseMessages.properties"/-->
	<!-->bean id="messageBean" class="se.vgregion.webbtidbok.MessageBean">
		<property name="properties" ref="test"/>
	</bean-->
    
    <!-- Login services. -->
    
	<bean id="loginService" class="se.vgregion.webbtidbok.Login">
		<property name="webServiceHelper" ref="helper"/>
		<property name="encrypter" ref="stringEncrypter"/>
	</bean>

    <bean id="validationService" class="se.vgregion.webbtidbok.ValidationLogin">
    </bean>
    
    <!-- Our lookup service. Currently a dummy. -->
    <bean id="lookupService" class="se.vgregion.webbtidbok.servicedef.DummyLookup">
        <property name="serviceDefinition" ref="serviceDefinitionMammografi" />
    </bean>

    <!-- Service definitions should be moved later, but for now this will do. -->
    <bean id="serviceDefinitionMammografi"
        class="se.vgregion.webbtidbok.servicedef.ServiceDefinition" />



	<bean id="bookingService" class="se.vgregion.webbtidbok.booking.BookingService">
		<property name="helper" ref="helper" />
	</bean>
	
	<bean id="helper" class="se.vgregion.webbtidbok.WebServiceHelper">
		<property name="encrypter" ref="stringEncrypter" />
	</bean>
	
	<bean id="stringEncrypter" class="se.vgregion.webbtidbok.crypto.StringEncrypter">
		<property name="keyStoreFile" value="classpath:asd.pfx" />
		<property name="keyAlias"
			value="a6c21dcdd9534d742aa1bd4afae16210_956e2a3a-b426-49f4-a107-72c603d2f58c" />
		<property name="keyPassWord" value="asd" />
	</bean>
	
	<bean id="calendarService" class="se.vgregion.webbtidbok.calendar.CalendarUtil">
		<property name="helper" ref="helper" />
	</bean>
	
	<bean id="loggingAdvice" class="se.vgregion.webbtidbok.logging.LoggingAdvice" />
	    <aop:config>
	        <aop:aspect ref="loggingAdvice">
	            <aop:pointcut id="loggingBookingServ"
	                expression="execution(* se.vgregion.webbtidbok.booking.BookingService.*(..))" />
	            <aop:pointcut expression="execution(* se.vgregion.webbtidbok.calendar.CalendarUtil.*(..))" id="loggingCalUtil"/>
	            <aop:around method="around" pointcut-ref="loggingBookingServ" />
	            <aop:around method="around" pointcut-ref="loggingCalUtil"/>
	        </aop:aspect>
	    </aop:config>
    
    <!-- Flow handler handling exceptions for the 'login' flow. -->
    <bean name="login" class="se.vgregion.webbtidbok.errorhandling.ExceptionFlowHandler">
    </bean>
	
	<!-- Imports the configurations of the different infrastructure systems of the application -->
	<import resource="webflow-config.xml" />
	<import resource="webmvc-config.xml" />
</beans>